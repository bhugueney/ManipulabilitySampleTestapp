
#ifndef _CLASS_ROBOT
#define _CLASS_ROBOT

#include "MatrixDefs.h"
#include "kinematic/Tree.h"

#include <memory>
#include <vector>
struct RobotPImpl;

class RobotVisitor_ABC;
class World;

class Robot {

public:
	typedef std::vector<Tree::TREE_ID> Gait; //sequence of walk. first appearance of id : anchor effector; second : get up

public:
	 explicit Robot(const matrices::Matrix4& /*transform*/); //basis switch
	~Robot();

//configure
public:
	void AddTree(Tree* tree);

//helpers
public:
	void  Accept(RobotVisitor_ABC& /*visitor*/) const;
	const matrices::Matrix4& ToWorldCoordinates() const;
	const matrices::Matrix4& ToRobotCoordinates() const;
	const unsigned int GetNumTrees() const;
	Tree* GetTree(Tree::TREE_ID /*id*/) const;
	void  SetGait(const Gait& /*gait*/);
	const Gait& GetGait();
	Tree::TREE_ID GetCurrentGait() const;
	Tree::TREE_ID GetNextGait() const;
	Tree::TREE_ID IncreaseGait();

//action
public:
	void Move(const matrices::Vector3& /*direction*/, const World& /*world*/); 
	void Reset(); 
	void Translate(const matrices::Vector3& /*direction*/); 
	void SetPosOri(const matrices::Matrix4& /*transform*/); 
	void Rest(); 

	Robot* Clone() const;

private:
	std::auto_ptr<RobotPImpl> pImpl_;
	unsigned int numTrees_;
	Gait gait_;
	int currentGait_;
};

#endif //_CLASS_ROBOT
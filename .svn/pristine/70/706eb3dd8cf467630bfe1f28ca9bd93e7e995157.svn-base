#include "XboxMotion.h"
#include "MotionHandler.h"
#include "Simulation.h"
#include "MatrixDefs.h"

using namespace matrices;
using namespace xbox;

XboxMotion::XboxMotion()
	: controller_(1)
{
	// NOTHING
}

XboxMotion::~XboxMotion()
{
	// NOTHING
}


void XboxMotion::Update(const Timer::t_time t, const Timer::t_time dt)
{
	MotionHandler& handler = Simulation::GetInstance()->motionHandler_;
	controller_.Update();	
	float xL, yL;
	float xR, yR;
	bool transformed = false;
	const float slowDownFactor = 0.0042f;
	controller_.GetLeftStickMovingVector(xL, yL);
	controller_.GetRightStickMovingVector(xR, yR);
	if( xL != 0 || yL != 0)
	{
		handler.Translate(Vector3(0.,-((double)xL * slowDownFactor*3), ((double)yL * slowDownFactor * 2)));
		transformed = true;
	}
	if(controller_.AllPressed((int)xbox::Buttons::A))
	{
		handler.Translate(Vector3(slowDownFactor*2, 0., 0.));
		transformed = true;
	}
	if(controller_.AllPressed((int)xbox::Buttons::B))
	{
		handler.Translate(Vector3(-slowDownFactor*2, 0., 0.));
		transformed = true;
	}
	if(controller_.AllPressed((int)xbox::Buttons::Y))
	{
		Simulation::GetInstance()->Reset();
	}
}

void XboxMotion::Reset()
{
}
